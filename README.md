# Hybrid models for time-series processing

Совместный репозиторий для гибридных моделей временных рядов (вейвлет + нейросеть).
Архитектура теперь организована как пакет `hybridts`, чтобы удобно переиспользовать
обучающие пайплайны и подключать другие модели (например, Helformer).

## Сetup

1. Создайте виртуальное окружение и установите зависимости:
   ```bash
   python -m venv .venv
   source .venv/bin/activate
   pip install -e .
   ```
2. Скопируйте `.env.example` в `.env` и при необходимости поправьте пути к данным:
   ```
   cp .env.example .env
   ```
3. При необходимости задайте параметры эксперимента в `configs/m3_eval.json`.

## Структура

```
src/hybridts/
├── config/          # загрузка настроек и переменных окружения
├── data/            # утилиты для датасета M3 (подготовка CSV, метрики, графики)
├── models/          # реализации базовых моделей (TimesNetV2, N-BEATS, сюда же позже Helformer)
├── hybrids/         # модуль MODWT и HybridPlus
├── training/        # датасеты скользящих окон, конфиги обучения и цикл train_model
└── pipelines/       # воспроизводимые пайплайны (например, evaluate_m3_hybrids)
```

Поверх пакета оставлены «шлюзы» (`train_utils.py`, `m3_utils.py`, `hybrids/modwt_hybrid.py`, …),
чтобы старые ноутбуки продолжили работать без правок импортов.

## Запуск экспериментов

Пример для гибридных моделей на M3:
```bash
python eval_m3.py --config configs/m3_eval.json
```
Файл конфига хранит параметры пайплайна (категории, количество рядов, число эпох и т.д.)
и легко расширяется под будущие сценарии.

## Как добавить Helformer (или другую модель)

1. Реализуйте модель в `src/hybridts/models/helformer.py`.
2. Экспортируйте класс в `src/hybridts/models/__init__.py`.
3. Зарегистрируйте его в `src/hybridts/models/factory.py`, чтобы гибриды могли вызывать `make_model("helformer", cfg)`.
4. При необходимости создайте новый пайплайн в `src/hybridts/pipelines/` или новую запись в `configs/`.

Такой подход обеспечивает единый интерфейс обучения, единые настройки окружения и готовые
hooks для тестирования разных архитектур.
